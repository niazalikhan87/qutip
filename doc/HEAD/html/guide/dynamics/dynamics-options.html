
<!DOCTYPE html><html>
<head>
    <meta http-equiv="Content-Type"
          content="text/html; charset=utf-8"/>
    
        <title>Setting Options for the Dynamics ODE Solvers &mdash; QuTiP 2.1 Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='http://fonts.googleapis.com/css?family=Crete+Round' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="../../_static/sphinx-bootstrap.css" type="text/css"/>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css"/>
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
        <script type="text/javascript">
            var DOCUMENTATION_OPTIONS = {
                URL_ROOT:'../../',
                VERSION:'2.1.0',
                COLLAPSE_INDEX:false,
                FILE_SUFFIX:'.html',
                HAS_SOURCE:  true
            };
        </script>
            <script type="text/javascript" src="../../_static/jquery.js"></script>
            <script type="text/javascript" src="../../_static/underscore.js"></script>
            <script type="text/javascript" src="../../_static/doctools.js"></script>
            <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            <script type="text/javascript" src="../../_static/bootstrap-dropdown.js"></script>
            <link rel="shortcut icon" href="../../_static/favicon.ico"/>
        <link rel="top" title="QuTiP 2.1 Documentation" href="../../index.html"/>
            <link rel="up" title="Evaluating Quantum System Dynamics" href="../guide-dynamics.html"/>
            <link rel="next" title="Solving for Steady-State Solutions" href="../guide-steady.html"/>
            <link rel="prev" title="Performance (QuTiP vs. qotoolbox)" href="dynamics-performance.html"/> 
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
    
        <!-- analytics -->
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-16824831-3']);
            
            _gaq.push(['_trackPageview']);

            (function () {
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();
        </script>
    
</head>
<body>

    <div class="navbar navbar-static-top">
        <div class="navbar-inner">
            <div class="container">


<div style="background-color: #EBEBEB; text-align: left; padding: 0px 0px 15px 15px; -webkit-border-radius:14px; -moz-border-radius:14px; border-radius:14px; margin: 1em;">
<a href="../../index.html"><img src="../../_static/logo.png" border="0" alt="qutip"/></a>
</div>


    <div class="related">
        <ul class="nav">
                <li class=""><a href="../../index.html">home</a></li>
                <li>
                    <a href="../../genindex.html"
                       title="General Index" accesskey="I">index</a>
                </li>
                <li>
                    <a href="../../py-modindex.html"
                       title="Python Module Index" >modules</a>
                </li>
                <li>
                    <a href="../guide-steady.html"
                       title="Solving for Steady-State Solutions" accesskey="N">next</a>
                </li>
                <li>
                    <a href="dynamics-performance.html"
                       title="Performance (QuTiP vs. qotoolbox)" accesskey="P">previous</a>
                </li>
                <li><a href="../guide.html"
                        >QuTiP Users Guide</a>
                </li>
                <li><a href="../guide-dynamics.html"
                        accesskey="U">Evaluating Quantum System Dynamics</a>
                </li> 
        </ul>
    </div>

                <div class="pull-right">
                    
        <form class="navbar-search" action="../../search.html"
              method="get">
            <input type="text" name="q" placeholder="search"/>
            <input type="hidden" name="check_keywords" value="yes"/>
            <input type="hidden" name="area" value="default"/>
        </form>
                </div>
            </div>
        </div>
    </div>
  
    <div class="container">
        <div class="content row">
                <div class="span9">
                    
  <div class="section" id="setting-options-for-the-dynamics-ode-solvers">
<span id="odeoptions"></span><h1>Setting Options for the Dynamics ODE Solvers<a class="headerlink" href="#setting-options-for-the-dynamics-ode-solvers" title="Permalink to this headline">Â¶</a></h1>
<p>Occasionally it is necessary to change the built in parameters of the ODE solvers used by both the <tt class="docutils literal"><span class="pre">mesolve</span></tt> and <tt class="docutils literal"><span class="pre">mcsolve</span></tt> functions.  The ODE options for either of these functions may be changed by calling the Odeoptions class <a class="reference internal" href="../../apidoc/classes.html#qutip.Odeoptions" title="qutip.Odeoptions"><tt class="xref py py-class docutils literal"><span class="pre">qutip.Odeoptions</span></tt></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">opts</span><span class="o">=</span><span class="n">Odeoptions</span><span class="p">()</span>
</pre></div>
</div>
<p>the properties and default values of this class can be view via the <cite>print</cite> command:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">opts</span>
<span class="go">    Odeoptions properties:</span>
<span class="go">    ----------------------</span>
<span class="go">    atol:          1e-08</span>
<span class="go">    rtol:          1e-06</span>
<span class="go">    method:        adams</span>
<span class="go">    order:         12</span>
<span class="go">    nsteps:        1000</span>
<span class="go">    first_step:    0</span>
<span class="go">    min_step:      0</span>
<span class="go">    max_step:      0</span>
<span class="go">    tidy:          True</span>
<span class="go">    num_cpus:      8</span>
<span class="go">    rhs_filename:  None</span>
<span class="go">    rhs_reuse:     False</span>
<span class="go">    gui:           True</span>
<span class="go">    mc_avg:            True</span>
</pre></div>
</div>
<p>These properties are detailed in the following table.  Assuming <tt class="docutils literal"><span class="pre">opts=Odeoptions()</span></tt>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="17%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Default setting</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>opts.atol</td>
<td>1e-8</td>
<td>Absolute tolerance</td>
</tr>
<tr class="row-odd"><td>opts.rtol</td>
<td>1e-6</td>
<td>Relative tolerance</td>
</tr>
<tr class="row-even"><td>opts.method</td>
<td>&#8216;adams&#8217;</td>
<td>Solver method.  Can be &#8216;adams&#8217; (non-stiff) or &#8216;bdf&#8217; (stiff)</td>
</tr>
<tr class="row-odd"><td>opts.order</td>
<td>12</td>
<td>Order of solver.  Must be &lt;=12 for &#8216;adams&#8217; and &lt;=5 for &#8216;bdf&#8217;</td>
</tr>
<tr class="row-even"><td>opts.nsteps</td>
<td>1000</td>
<td>Max. number of steps to take for each interval</td>
</tr>
<tr class="row-odd"><td>opts.first_step</td>
<td>0</td>
<td>Size of initial step.  0 = determined automatically by solver.</td>
</tr>
<tr class="row-even"><td>opts.min_step</td>
<td>0</td>
<td>Minimum step size.  0 = determined automatically by solver.</td>
</tr>
<tr class="row-odd"><td>opts.max_step</td>
<td>0</td>
<td>Maximum step size.  0 = determined automatically by solver.</td>
</tr>
<tr class="row-even"><td>opts.tidy</td>
<td>True</td>
<td>Whether to run tidyup function on time-independent Hamiltonian.</td>
</tr>
<tr class="row-odd"><td>opts.num_cpus</td>
<td>installed num
of processors</td>
<td>Integer number of cpu&#8217;s used by mcsolve.</td>
</tr>
<tr class="row-even"><td>opts.rhs_filename</td>
<td>None</td>
<td>RHS filename when using compiled time-dependent Hamiltonians.</td>
</tr>
<tr class="row-odd"><td>opts.rhs_reuse</td>
<td>False</td>
<td>Reuse compiled RHS function.  Useful for repeatative tasks.</td>
</tr>
<tr class="row-even"><td>opts.gui</td>
<td>True (if GUI)</td>
<td>Use the mcsolve progessbar. Defaults to False on Windows.</td>
</tr>
<tr class="row-odd"><td>opts.mc_avg</td>
<td>True</td>
<td>Average over trajectories for expectation values from mcsolve.</td>
</tr>
</tbody>
</table>
<p>As an example, let us consider changing the number of processors used, turn the GUI off, and strengthen the absolute tolerance.  There are two equivalent ways to do this using the Odeoptions class.  First way,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">opts</span><span class="o">=</span><span class="n">Odeoptions</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opts</span><span class="o">.</span><span class="n">num_cpus</span><span class="o">=</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opts</span><span class="o">.</span><span class="n">gui</span><span class="o">=</span><span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opts</span><span class="o">.</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-10</span>
</pre></div>
</div>
<p>or one can use an inline method,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">opts</span><span class="o">=</span><span class="n">Odeoptions</span><span class="p">(</span><span class="n">num_cpus</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">gui</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the order in which you input the options does not matter.  Using either method, the resulting <cite>opts</cite> variable is now:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">opts</span>
<span class="go">Odeoptions properties:</span>
<span class="go">----------------------</span>
<span class="go">atol:          1e-10</span>
<span class="go">rtol:          1e-06</span>
<span class="go">method:        adams</span>
<span class="go">order:         12</span>
<span class="go">nsteps:        1000</span>
<span class="go">first_step:    0</span>
<span class="go">min_step:      0</span>
<span class="go">max_step:      0</span>
<span class="go">tidy:          True</span>
<span class="go">num_cpus:      3</span>
<span class="go">rhs_filename:  None</span>
<span class="go">rhs_reuse:     False</span>
<span class="go">gui:           False</span>
<span class="go">mc_avg:    True</span>
</pre></div>
</div>
<p>To use these new settings we can use the keyword argument <tt class="docutils literal"><span class="pre">options</span></tt> in either the <tt class="docutils literal"><span class="pre">mesolve</span></tt> or <tt class="docutils literal"><span class="pre">mcsolve</span></tt> function.  We can modify the last example as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mesolve</span><span class="p">(</span><span class="n">H0</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">c_op_list</span><span class="p">,</span> <span class="p">[</span><span class="n">sigmaz</span><span class="p">()],</span><span class="n">options</span><span class="o">=</span><span class="n">opts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesolve</span><span class="p">(</span><span class="n">hamiltonian_t</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">c_op_list</span><span class="p">,</span> <span class="p">[</span><span class="n">sigmaz</span><span class="p">()],</span> <span class="n">H_args</span><span class="p">,</span><span class="n">options</span><span class="o">=</span><span class="n">opts</span><span class="p">)</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mcsolve</span><span class="p">(</span><span class="n">H0</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">ntraj</span><span class="p">,</span><span class="n">c_op_list</span><span class="p">,</span> <span class="p">[</span><span class="n">sigmaz</span><span class="p">()],</span><span class="n">options</span><span class="o">=</span><span class="n">opts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcsolve</span><span class="p">(</span><span class="n">hamiltonian_t</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">ntraj</span><span class="p">,</span> <span class="n">c_op_list</span><span class="p">,</span> <span class="p">[</span><span class="n">sigmaz</span><span class="p">()],</span> <span class="n">H_args</span><span class="p">,</span><span class="n">options</span><span class="o">=</span><span class="n">opts</span><span class="p">)</span>
</pre></div>
</div>
</div>


                    
                </div>
                <div class="span3">
                    
        <div class="sphinxsidebar">
            <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="dynamics-performance.html"
                        title="previous chapter">Performance (QuTiP vs. qotoolbox)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../guide-steady.html"
                        title="next chapter">Solving for Steady-State Solutions</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/guide/dynamics/dynamics-options.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
            </div>
        </div>
                </div>
            
        </div>
    </div>
    <div class="footer">
        
        <div class="container">
                    &copy;
                        Copyright 2011-2012, P.D. Nation, J.R. Johansson.
                Last updated
                    on Sep 27, 2012.
                Created using <a
                        href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3
                    .
        </div>
    </div>



<script type="text/javascript">
    $('.nav .active').on('click', function () {
        e.preventDefault()
        $(this).siblings().toggle()
    });
</script>



</body>
</html>